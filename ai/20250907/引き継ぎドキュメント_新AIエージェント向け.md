# 新AIエージェント向け引き継ぎドキュメント

## 🎯 このドキュメントの目的

あなたは、/Documents/Appと/Documents/Obsidian VaultをCursorで開いているAIエージェントです。
このドキュメントは、これまでの開発経緯と現状を理解し、効果的にプロジェクトを継続するための引き継ぎ資料です。

---

## 📂 プロジェクト構成の概要

### メインプロジェクト群（/Documents/App）

```
App/
├── minimum-sns-post-app1/    # 匿名投稿SNSアプリ（Vue.js + Java + PostgreSQL）
├── RestaurantApp/                 # 飲食店向け営業準備支援アプリ（Next.js + Supabase）
│   └── operations-prepare/   # ← メイン開発対象
├── Tools/                    # 共通開発支援ツール群
└── rust-app-example/         # Rust学習プロジェクト
```

### 開発ルール・方針（必読）

**重要：以下のルールファイルを必ず参照してください**

1. **base-rule.mdc** - 開発の基本方針とルール
   - 日本語での回答必須
   - データ中心設計
   - ベタ書き禁止（区分値・ラベル・メッセージ管理の徹底）
   - テストコード必須作成
   - Git管理（mainブランチ直push禁止）

2. **gem-rule-copy** - 技術的知見とサポート方針
   - React/Next.js, PostgreSQL, Supabaseを主軸
   - 本業でJava/Vue/PostgreSQL/DynamoDB等も使用
   - Future株式会社の技術ガイドライン参考

3. **past_criticisms&responses** - 過去の指摘事項と改善点
   - **重要：リポジトリ内容を自分で積極的に確認・調査すること**
   - ユーザーに「ファイルを貼ってください」等の指示は不要
   - 必ずソースコードを読んで根拠を持って対応案を提示
   - 区分値・ラベル・メッセージ管理の仕組み活用必須

---

## 🚀 現在のメイン開発プロジェクト：App/operations-prepare

### プロジェクト概要

**目的：** 飲食店の翌日営業準備業務を効率化するアプリケーション  
**技術スタック：** Next.js + TypeScript + Supabase + shadcn/ui  
**ターゲット：** スマートフォンでの片手操作を最優先  
**リリース目標：** 2025年6月30日  

### 主要機能

1. **トップページ** ✅ 完成
   - 業務日付管理
   - 予約管理
   - 自動保存機能

2. **在庫確認業務画面** ✅ 完成
   - 補充先切り替え
   - 在庫確認ステータス管理（未確認→確認済/確認不要）
   - 補充ステータス管理（補充不要→要補充）
   - API連携完了

3. **補充業務画面** ✅ 完成
   - 移動補充・作成補充の管理
   - 自動保存機能
   - API連携完了

4. **発注依頼業務画面** ✅ 完成
   - 発注ステータス管理
   - API連携完了

5. **営業準備状況一覧画面** ⚠️ 未完了
   - 全体の進捗状況表示
   - API連携が必要

### 技術的な重要ポイント

#### データベース設計
- Supabase（PostgreSQL）を使用
- 主要テーブル：
  - `reservations` - 予約データ（商品名・予約数の組み合わせ）
  - `inventory_status` - 在庫確認状況
  - `replenishment_status` - 補充状況
  - `order_requests` - 発注依頼

#### 設計思想
- **商品マスタは存在しない** - 商品名は画面入力値のみ
- **item_idやproduct_idは不要** - reservationテーブルにはそのようなカラムは存在しない
- **スマホファースト** - 片手操作を最優先
- **自動保存** - 入力終了時・一定時間後に自動保存

#### コーディングルール
- **区分値管理：** `enum-definitions.yaml` + `enum-utils.ts`
- **ラベル管理：** `labels.ts`で一元管理
- **メッセージ管理：** `messages.ts`でエラーメッセージ管理
- **テスト：** `__tests__`配下でディレクトリ構成を再現

---

## 📈 現在の開発状況

### 完了済み項目

- [x] 基本的な画面実装とAPI連携
- [x] 自動保存機能
- [x] 認証機能（Supabase Auth + Google）
- [x] 区分値・ラベル・メッセージ管理の仕組み
- [x] 楽観的ロック機能

### 現在の課題・未完了項目

- [ ] **営業準備状況一覧画面のAPI連携**
- [ ] **テスト基盤の整備**（Vitest導入、テストカバレッジ向上）
- [ ] **インフラ構築**（AWS環境構築・デプロイ）

### 直近の作業履歴

最近は以下の作業を進めていました：

1. **楽観的ロックの実装** - データ更新時の競合検知機能
2. **エラーハンドリングの改善** - フロントエンドでのエラー表示
3. **UIの細かい調整** - スマホでの操作性向上

---

## 🔧 開発環境・設定

### 必要な環境
- Node.js
- PostgreSQL 17
- Supabase CLI

### 重要な設定ファイル
- `package.json` - 依存関係
- `supabase/config.toml` - Supabase設定
- `.env.local` - 環境変数（認証無効化は`NEXT_PUBLIC_DISABLE_AUTH=true`）

### コマンド実行時の注意
- PowerShellでは`&&`が使えない → `;`を使用
- 作業ディレクトリ：`cd operations-prepare`

---

## 📋 次のアクション項目

### 優先度：高
1. **営業準備状況一覧画面の完成**
   - API連携の実装
   - 全体進捗の可視化

2. **テスト基盤の整備**
   - Vitestの本格導入
   - 主要機能のテストカバレッジ向上

### 優先度：中
3. **インフラ構築準備**
   - AWS学習・環境構築
   - デプロイ自動化

### 優先度：低
4. **機能拡張**
   - パフォーマンス最適化
   - 追加機能の検討

---

## 🎯 開発時の重要な注意事項

### 必須事項
1. **ソースコード確認を怠らない** - 必ず関連ファイルを読んでから回答
2. **共通管理の徹底** - 区分値・ラベル・メッセージ管理の仕組みを活用
3. **テストコードセット作成** - 新規実装時は必ずテストも作成
4. **スマホファーストUI** - 片手操作を最優先に考慮

### 禁止事項
1. **存在しないカラムの参照** - item_id, product_id等は存在しない
2. **ベタ書き** - 日本語やマジックナンバーの直接記述
3. **UIの破壊** - 既存の動作するUIを壊さない
4. **ユーザーへの作業指示** - 自分で必要なファイルを確認・修正

---

## 📚 重要ドキュメントの場所

### 設計ドキュメント
- `docs/アプリケーション作成指示記録.md` - 開発指示の記録
- `docs/アプリケーション概念設計ノート.md` - 設計思想とUI要件
- `docs/database_schema.md` - DB設計
- `docs/進捗管理ボード.md` - 現在の進捗状況

### 開発ルール
- `base-rule.mdc` - 基本開発ルール
- `docs/naming-conventions.yml` - 命名規則
- `docs/test/` - テスト仕様書

### 進捗管理
- `docs/Management/project_schedule.md` - プロジェクトスケジュール
- `docs/meeting-notes/` - 議事録

---

## 🚀 開始時のアクション

**新AIエージェントとして最初に行うべきこと：**

1. **両フォルダの内容を読み込む**
   - `/Documents/App` 全体の構成把握
   - `/Documents/Obsidian Vault` の内容確認（もし存在すれば）

2. **現状確認**
   - 現在のgitブランチ・状況確認
   - 最新の進捗状況把握
   - 未解決の課題・エラーの有無確認

3. **次のアクション提案**
   - 優先度に基づく作業計画の提示
   - 具体的な実装方針の相談

---

**このドキュメントを読み終えたら、まず両フォルダの内容を確認し、現在の状況を把握してから、ユーザーとの対話を開始してください。**
