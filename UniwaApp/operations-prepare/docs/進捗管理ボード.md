# 進捗管理ボード

## ゴール

- 2025年6月末までに業務アプリをリリースし、現場運用を開始する

---

## 現状（2025/06/07時点）

- トップページ・サイドパネルは完成
- 在庫確認画面のAPI連携が未完了
- テスト基盤は未整備

---

## 今週の目標（2025/06/02〜2025/06/08）

- [ ] 在庫確認画面API連携を完了させる
- [ ] テスト基盤（Vitest）の導入準備

---

## マイルストーン＆スケジュール

| マイルストーン          | 期限       | 達成基準                  |
| ----------------------- | ---------- | ------------------------- |
| 在庫確認画面API連携完了 | 2025/06/09 | CRUD全てのAPI疎通ができる |

---

## 残Todo（階層構造・チェックリスト）

- [x] 在庫確認業務画面
  - [x] API連携
    - [x] CRUD全ての疎通
    - [x] エラーハンドリング
  - [x] メモ機能
  - [x] 自動保存機能
- [x] 補充業務画面
  - [x] API連携
    - [x] CRUD全ての疎通
    - [x] エラーハンドリング
  - [x] 自動保存機能
  - [x] 表示制御
    - [x] 要補充・補充済のみの表示に絞り込み
    - [x] 補充パターン区分が移動の品物のみ表示
- [x] 作成業務画面
  - [x] 画面設計
  - [x] API連携
  - [x] ステータス管理
  - [x] 自動保存機能
- [x] 発注依頼業務画面
  - [x] API連携
  - [x] ステータス管理
  - [x] 自動保存機能
- [x] API ROUTEの導入
  1. [x] API→lib/db-service.ts, lib/utils/inventory-status-utils.tsの部分作る
  2. [x] 各画面（page.tsx）→APIの部分作る
  3. [x] 全体を連動させてみてバグフィックス
- [ ] 営業準備状況一覧画面
  - [ ] API連携
  - [ ] ステータス表示
- [ ] テスト基盤
  - [ ] Vitest導入
  - [ ] 主要コンポーネントのテスト作成
  - [ ] テストカバレッジ測定
- [ ] インフラ構築
  - [ ] Vercel設定
    - [ ] プロジェクト作成
    - [ ] GitHubリポジトリ連携
    - [ ] 環境変数設定
      - [ ] 開発環境
      - [ ] 本番環境
    - [ ] デプロイ設定
  - [ ] Supabase本番環境構築
    - [ ] 本番用プロジェクト作成
    - [ ] マイグレーション実行
      - [ ] テーブル作成
      - [ ] RLSポリシー設定
    - [ ] サンプルデータ移行（必要に応じて）
  - [ ] 本番環境デプロイ
    - [ ] 環境変数の本番設定
    - [ ] 初回デプロイ
    - [ ] 動作確認
  - [ ] 監視設定
    - [ ] Vercel Analytics設定
    - [ ] エラーログ監視
    - [ ] パフォーマンス監視
- [ ] 認証認可
  - [ ] ログイン・ログアウト
  - [ ] API呼び出しでのJWT認証
- [x] 業務日付がグローバルで管理されてない
- [ ] ステータス遷移の制御機構の検討
- [ ] 楽観的ロックの実装
  - [ ] 共通基盤の実装
    - [ ] 楽観的ロックの基本実装（db-service.ts）
      - [ ] updated_atを楽観的ロックとして活用
      - [ ] 更新時のバージョンチェック処理
      - [ ] 競合検知の仕組み
      - [ ] 特定のItemの再取得機能
    - [ ] エラー型の定義（types.ts）
      - [ ] 競合エラー型
      - [ ] 再取得エラー型
      - [ ] 保存エラー型
    - [ ] エラーメッセージの定義（messages.ts）
      - [ ] 競合エラーメッセージ
      - [ ] 再取得メッセージ
      - [ ] 保存失敗メッセージ
  - [ ] 共通UIの実装
    - [ ] エラー表示の共通化
      - [ ] トースト通知
      - [ ] エラーダイアログ
      - [ ] インラインエラー表示
    - [ ] 再取得中の表示
      - [ ] ローディングインジケータ
      - [ ] 再取得中の状態表示
  - [ ] 自動保存との連携
    - [ ] 保存失敗時の処理
      - [ ] エラー検知
      - [ ] 再試行ロジック
      - [ ] 最大再試行回数の設定
    - [ ] 再試行の制御
      - [ ] バックオフ戦略
      - [ ] キューイング
  - [ ] 各画面への適用
    - [ ] 在庫確認画面
      - [ ] チェック状態の更新
      - [ ] 在庫数の更新
      - [ ] 補充数の更新
    - [ ] 補充業務画面
      - [ ] 補充状態の更新
      - [ ] 作成状態の更新
    - [ ] 作成業務画面
      - [ ] 作成状態の更新
      - [ ] 発注状態の更新
    - [ ] 発注依頼業務画面
      - [ ] 発注状態の更新
    - [ ] 営業準備状況一覧画面
      - [ ] 表示状態の更新
  - [ ] テスト
    - [ ] 競合シナリオのテスト
    - [ ] 再取得シナリオのテスト
    - [ ] エラー表示のテスト
    - [ ] 自動保存のテスト
- [ ] ItemのCardを全機能で共通化して必要な項目だけをチョイスする使い方にしたい
  - [ ] 一覧画面から各品物の個別編集画面に行けるようにもしたい（このときはItemのCardの全項目がいじれる状態、みたいな。）

---

## メモ・課題

- AWSの学習時間が足りない
- テストの自動化をどうするか検討中
