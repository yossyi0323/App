## 業務フロー・設計意図
- 飲食店の翌日営業準備業務をスマホファーストで効率化
- DBスキーマ・画面設計・業務フローは全て現状の構成に準拠
- 画面・機能はシンプル操作・自動保存・認証・ダークモード切替を重視
- 今後の拡張（認可・権限管理・パフォーマンス最適化等）も見据えて設計

ある飲食店の翌日の営業に向けた準備のための補充業務で、補充元と補充先がそれぞれバラバラな位置にあるためこれを管理できるアプリを作ろうと思っている。
以下は、そのために必要そうなマスタの定義や画面操作を考えてみたものだ。試しに書き起こしてみた業務フローも載せるから、これをもとに以下のアウトプット（アプリを含む）を作ってほしい。
ドキュメントはmd形式、図形やフローチャートなどの何らかの描画が必要な場合は、マークダウンのプレビューで表示できるmermaidの記法で記述したものにしてくれ。

技術要素としては、DBにはPostgreSQL、サーバーサイドはJava、クライアントサイドはVue.jsを使って作ってほしい。
Nuxtは使わずに、今後の拡張やユーザーの使い勝手を考慮して、UIはマテリアルデザインに倣ったUIにしたいので適宜UIライブラリなどを活用して作ってほしい。
ライブラリなどを利用する場合は、どういう技術をなぜ採用したのか、それをどこでどう使っているのかもまとめたドキュメントも用意しておいてほしい。
ライトモードとダークモードにも対応したい。

まずは開発環境を整えたうえで、トップページと在庫確認業務画面から作っていってほしい。

- 画面設計書
	- 画面の概要、機能の概要と詳細、各操作時の挙動、画面項目ごとの詳細な定義などを記載したもの
- 業務フロー
	- このアプリケーションが想定する業務フローを記載したもの
- 操作説明書
	- 操作手順が記載されているもの
- ER図
	- 生成したアプリケーションが想定しているテーブルの定義情報
- DDL/DML
	- 値はメモを参考にサンプルデータを入れておいてほしい。適宜書き換えて利用する。実データの受領や今後の管理は、可能ならスプレッドシートで行う想定。
- - アプリケーション
- 営業準備のアプリ化
	- 実現イメージ
		- DB（マスタ）
			- 場所マスタ
				- 補充元先区分
				- 場所ID
				- 場所名
				- データ
					- 補充元, 2階
					- 補充元, 3階
					- 補充元, キッチン
					- 補充元, その他
					- 補充元, ビレッジ
					- 補充先, 冷蔵庫
					- 補充先, スチコン下冷蔵庫
					- 補充先, 調味料棚
					- 補充先, スパイスラック
					- 補充先, 牛乳冷蔵庫
					- 補充先, 資材
			- 品物マスタ
				- 品物ID
				- 名前
			- 品物別前日営業準備マスタ
				- 品物ID
				- 補充パターン区分
				- 補充元の場所ID
				- 補充先の場所ID
				- 作成・発注依頼先
		- DB（トラン）
			- 在庫補充状況管理トラン
				- 業務日付
				- 品物ID
				- 在庫確認ステータス
				- 補充ステータス
				- 作成ステータス
				- 発注依頼ステータス
				- 在庫数
				- 補充数
				- 補充メモ
			- 商品予約トラン
				- 業務日付
				- 商品名（自由記入とするためtext型にする）
				- 予約数
			- 予約状況トラン
				- 業務日付
				- 予約状況（自由記入とするためtext型にする）
		- 区分値
			- 補充パターン区分
				- 移動
				- 作成
			- 在庫確認ステータス
				- 未確認（初期値）
				- 確認中
				- 確認済
				- 確認不要
			- 補充ステータス
				- 補充不要（初期値）
				- 要補充
				- 補充済
			- 作成ステータス
				- 作成不要（初期値）
				- 要作成
				- 作成済
				- 作成依頼済
			- 発注依頼ステータス
				- 発注不要（初期値）
				- 要発注依頼
				- 発注依頼済
    		- 補充元先区分
        		- 補充元
        		- 補充先
		- 画面
			- 画面遷移の作成：トップページと、各ページごとのサイドバーメニューから各ページへ移動できるようにする。
				- トップページ
					- 在庫確認業務
					- 補充（移動）業務
					- 補充（作成）業務
					- 発注依頼業務
					- 営業準備状況一覧
			- 画面内のレイアウトのイメージ
				- ヘッダー
					- ハンバーガーメニュー
					- ページ名
				- サイドバー
					- 各ページへのリンク
				- ページ本体
					- 各業務に応じて、品物のリストを表示。
						- ページによっては、ページ本体の上部に設けたプルダウンなどの入力UIから、補充先や補充元などの選択肢を選択可能とする。
						- その場合は、プルダウンで選択した補充先に紐づく品物を絞り込んでリスト表示できるようにする。
			- 画面のこだわってほしいポイント
				- スマートフォンの小さい画面での、片手での操作に最適化した、シンプルで簡単につかえるUIにしたい。
				- なるべく選択を選ばせずに、在庫数の入力、自由入力欄の入力、チェックボックスのチェック有り無しによる単純なステータスの双方向遷移などにより、在庫確認業務をスムーズに行えるようにしたい
				- 今後の拡張の見通しとしては、品物のユーザー操作による並べ替え、ユーザーごとの権限管理（管理者と一般ユーザーなど）、マスタ定義の更新（例えば標準補充量の変更など）の機能も追加したいが、いまは一旦不要とする。
				- LocalStorageへの一次保存とDBへのCRUDを組み合わせ、ユーザーの入力を自動保存する機構にする。
					- 今回のアプリケーションにおいては、入力欄がDBの1レコードとかなりきれいに対応付けられており（例外的なのは予約入力欄くらいだ）、複数のテーブルへの更新が必要なような機能はない。
					- その特性を活かして、画面入力へのインプットは基本すべてlocalStorageに保存する仕組みとし、後で別のタイミングでDBに保存するようにしてみよう。文字入力を受けたときはlocalStorageに保存する。
						- 例えば、以下の3つのタイミングとかどうだろう。
							- 入力欄からカーソルが外れたタイミング
							- 一定期間（5秒とか）入力がなかったら1回保存
								- 再度入力を始めるまで、2回目の保存はしない。もう一度どこかに何かを入力したら、一定期間後にまた1回だけ保存。
							- より長いスパン（30秒とか）での自動保存
		- 業務フロー
			- 翌日の営業の予約内容を確認し、予約数や予約状況をメモする
			- 補充先マスタにある全ての補充先を確認して回って、各補充先にあるすべての品物の在庫数を確認し、補充数を算出する
				- 補充数は画面入力とする。
				- →品物ごとに標準補充量はあり、標準補充量-在庫数を補充量の初期値とする案もあったが、仕込みや在庫の状況、翌日の予約状況に応じて臨機応変に補充量は計算する必要があるため、ユーザーの判断にゆだねる。
			- 補充が必要なすべての品物を、補充先へ補充する
				- それぞれの補充元に行き、品物を補充数分だけ補充先へ移動し、補充する。
					- 補充元に在庫が少なくなっていたり、在庫がなくなってしまった場合は、作成担当者に作成を依頼するか、発注担当者に発注を依頼する。
				- 補充パターンが作成の場合は、作成依頼先へ作成を依頼する。
					- 補充するユーザーが作成も可能であれば、自身で作成する場合もある。
			- 補充が必要なすべての品物の補充が完了したら、在庫状況を報告する。
				- 作成が必要なものがすぐに作成できず、依頼中の状態のまま作業を終了する場合も、翌日の営業に入る人に連絡しておく
				- 発注が必要な品目があれば、リストアップして、発注担当者に発注を依頼する
				- 補充できずに在庫がないものがあれば、翌日の営業で売り切れとするメニューを翌日の営業に入る人と確認しておく
		- アプリケーションの挙動のイメージ（フロントエンドとバックエンド混在）
			- トップページ
				- 業務日付の入力欄、各ページを開くためのボタンと、紙で管理している翌日の営業に関する予約数や予約状況などをメモできる入力欄を設ける。
				- 紙で管理している翌日の営業に関する予約数や予約状況などをメモできるように入力欄を設けるだけで、予約状況トランと商品予約トランに書き込めればそれで十分。予約管理機能は今回は作らず、紙での運用のままにする。
				- シンプルで迷わない、スクロールも不要なUIとする。
			- 在庫確認業務
				- 補充先ごとに画面表示を切り替える
				- [ ] 補充先ごとに、未確認の件数または全件確認済みなら確認済件数のワッペンと、確認不要があればそのワッペンを表示する
				- 同じ補充先の品物のリストを表示し、品物の名前、在庫数入力欄、補充数入力欄、補充ステータス入力欄、在庫確認ステータス入力欄を設ける
					- 補充ステータス入力欄は、補充不要を初期値とするチェックボックスを右下に設けて、チェックを入れたら要補充とする。在庫確認業務では補充ステータスが補充済になることはない。
						- 品物別前日営業準備マスタの補充パターン区分が作成の品物については、補充ステータスが要補充になったら作成ステータスも要作成に、補充ステータスが補充不要になったら作成ステータスも作成不要に切り替える。
						- 補充数が空か0でないかぎり、補充数に値が入っていたら自動的に要補充にする
					- 在庫確認ステータス入力欄は初期値を未確認とする
						- 補充先が同じ品物は、一括で在庫確認ステータスを確認済みにできるような導線を設ける。
						- 品物リストの品物名の左にチェックボックスを設けて、falseは未確認、trueは確認済とする
					- 在庫の確認が不要な場合は、在庫確認ステータスを確認不要にするチェックボックスを左下に設ける。
						- 商品が売り切れの場合などに、補充の必要がそもそもない場合に利用する
						- 在庫数や補充数の値はそのままに入力欄を非活性として、要補充は補充不要にする。
				- 想定する操作フロー
					- 補充先リストを一つ一つ確認していく。
					- それぞれの補充先ごとに、全ての品物の在庫を確認し、現在の在庫数を入力する。
					- 補充が必要であれば補充数を入力するか、補充ステータスにチェックを入れて要補充にする。
						- 補充数に初期値の0または空文字以外の値が入った場合は、補充ステータスを自動で要補充にし、補充ステータスを表示するチェックボックスの表示もチェックありに切り替える。
			- 補充（移動）業務
				- 補充元ごとに画面表示を切り替える
				- 同じ補充元の品物のうち、品物別前日営業準備マスタの補充パターン区分が移動かつ、在庫確認業務にて在庫補充状況管理トランの補充ステータスが要補充となった品物のリストを表示する。
					- 品物の名前、在庫数表示欄、標準補充量の表示欄、補充数表示欄、補充ステータス入力欄を設ける
						- 補充ステータス入力欄は、要補充を初期値とするチェックボックスとし、チェックを入れたら補充済とする。補充業務では補充ステータスが補充不要になることはない。
						- 補充元が同じ品物は、一括で補充ステータスを補充済にできるような導線を設ける。
					- 補充元の在庫が不足している場合
						- 在庫補充状況管理トランの発注依頼ステータスを要発注依頼にするか、在庫補充状況管理トランの作成ステータスを要作成に変更する。
						- 補充メモを活用し、足りない材料などをはそちらに記載する。
			- 補充（作成）業務
				- 在庫確認業務にて在庫補充状況管理トランの補充ステータスが要補充、作成ステータスが要作成となった品物のうち、品物別前日営業準備マスタの補充パターン区分が作成の品物のリストを表示する。
				- 品物ごとに、品物の名前、在庫数表示欄、標準補充量の表示欄、補充数表示欄、作成依頼先表示欄、作成ステータス入力欄を設ける
					- 自分で作成できる場合は、補充する品物を作成し、作成ステータスは要作成から作成済にする
					- 自分で作成できない場合は、補充する品物の作成を依頼し、作成ステータスは要作成から作成依頼済に変更する
			- 発注依頼業務
				- 在庫確認業務にて在庫補充状況管理トランの発注依頼ステータスが要発注依頼となった品物のリストを表示する。
				- 品物ごとに、品物の名前、在庫数入力欄、標準補充量の表示欄、作成依頼先表示欄、作成ステータス入力欄を設ける
					- 在庫がなく発注が必要な品物の発注を依頼し、発注依頼ステータスは要発注依頼から発注依頼済に変更する
					- 一括で発注依頼ステータスを発注依頼済にできるような導線を設ける。
			- 営業準備状況一覧
				- 要対応品目一覧
					- 画面で入力している業務日付（デフォルトは当日）の品目のリストと、在庫数表示欄、標準補充量の表示欄、補充数表示欄、在庫確認ステータスの表示欄、補充ステータスの表示欄、作成ステータスの表示欄、発注依頼ステータスの表示欄を表示する
					- 在庫確認ステータスが未確認、または補充ステータスの要補充、または作成ステータスが要作成、または発注依頼ステータスステータスが要発注依頼の品物を絞り込んだ状態を「要対応」とし、要対応にチェックを入れていることで要対応の品物のみに絞り込んだ状態のリストを初期状態とする