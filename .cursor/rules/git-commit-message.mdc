---
description: git commitメッセージ作成時のルール
---

# git commitメッセージ作成時のルール

## 目的

CursorのAIにgit操作のためのcommitメッセージの考案を依頼する際のルールを定義する。

**重要：** 
- AIはcommitメッセージの文字列を提案するだけで、実際のgit操作（commit）はユーザーが行う。コピーできる形で文字列を提供する。
- **コミットメッセージは必ず「feat: 変更内容」形式に統一する**（VS CodeのAI Commit Message機能を使う場合も含む）

---

## 基本原則

### 1. 日本語で記述する

commitメッセージは基本日本語で記述する。

### 2. 形式は「feat: 変更内容」

commitメッセージは以下の形式で記述する：

```
feat: 変更内容
```

**プレフィックスの種類：**
- `feat:`：新機能の追加
- `fix:`：バグ修正
- `refactor:`：リファクタリング
- `docs:`：ドキュメントの変更
- `style:`：コードスタイルの変更（動作に影響しない）
- `test:`：テストの追加・変更
- `chore:`：ビルドプロセスやツールの変更

変更内容に応じて適切なプレフィックスを選択する。

### 3. 文字数制限

commitメッセージは短文から長くても30文字程度に収める。

**良い例：**
- `feat: ユーザー認証機能を追加`
- `fix: ログイン時のエラーハンドリングを修正`
- `refactor: APIレスポンス処理を共通化`

**悪い例：**
- `feat: ユーザー認証機能を追加し、ログイン画面とパスワードリセット機能も実装した`（長すぎる）

### 4. git add済みの変更のみを対象とする

**最重要：commitメッセージは、`git add`でステージング済みの変更のみを基に作成する。**

**理由：**
- `git add`していない変更は、まだコミットに含めるかどうか未確定
- 別のコミットに分けたい意図がある可能性がある
- ステージング済みの変更のみが、今回のコミットに含まれる内容

**実行手順：**
1. `git status`でステージング済みの変更を確認
2. `git diff --cached`でステージング済みの変更内容を確認
3. ステージング済みの変更のみを基にcommitメッセージを作成
4. `git diff`（ステージング前の変更）は参照しない

**悪い例：**
- ステージング前の変更も含めてcommitメッセージを作成
- `git diff`の結果を基にcommitメッセージを作成

**良い例：**
- `git diff --cached`の結果のみを基にcommitメッセージを作成
- ステージング済みの変更のみを説明するメッセージ

---

## commitメッセージ作成時の確認事項

1. **ステージング済みの変更を確認したか？**
   - `git status`で確認
   - `git diff --cached`で内容を確認

2. **ステージング前の変更を参照していないか？**
   - `git diff`は参照しない
   - ワークツリーの変更は無視する

3. **適切なプレフィックスを選択したか？**
   - 変更内容に応じたプレフィックスを使用

4. **文字数制限を守っているか？**
   - 30文字程度に収まっているか

5. **日本語で記述しているか？**
   - 基本日本語で記述

---

## 実行例

### ユーザーの依頼

「commitメッセージを作成して」

### AIの実行手順

1. `git status`を実行してステージング済みの変更を確認
2. `git diff --cached`を実行して変更内容を確認
3. 変更内容を分析して適切なプレフィックスを選択
4. 30文字程度の日本語メッセージを作成
5. **コピーできる形で文字列を提供**（実際のcommit操作はユーザーが行う）

### 出力例

コピーできる形で文字列を提供：

```
feat: ユーザー認証機能を追加
```

または

```
fix: ログイン時のエラーハンドリングを修正
```

**注意：** コードブロック内の文字列をそのままコピーして使用できる形式で提供する。

---

## 重要な注意事項

- **絶対にステージング前の変更を参照しない**
- **`git diff --cached`のみを使用する**
- **ステージング済みの変更のみを説明する**
- **ユーザーが意図的に分けたいコミットを混ぜない**

---

## AIによる能動的なコミット提案

### 基本方針

**目的：** ユーザーが個人作業でもGitを日常的に使い、適切なコミット習慣を身につける

**役割：** AIは秘書として、作業の区切りでコミットを提案する

**重要：** ユーザーは「タイミングを考えるのが手間」「忘れがちでDiffが溜まると見づらい」と感じているため、**積極的に都度都度提案する**ことが求められている。

### 提案のタイミング（積極的に提案すべき場面）

**必ず提案すべき場面：**

1. **作業の区切りがついた時**
   - 1つの機能や修正が完了した時
   - ドキュメント更新が完了した時
   - リファクタリングが完了した時
   - テストが追加・修正された時
   - **ルールファイルを更新した時**
   - **セッションログを記録した時**

2. **変更が積み重なった時**
   - 2-3個以上のファイルを変更した時（3-5個を待たない）
   - 関連する変更がまとまった時
   - **ステージング済みの変更がある時**

3. **作業セッションの終了時**
   - ユーザーが「今日はここまで」と言った時
   - セッション終了の合図があった時

4. **定期的な確認**
   - 作業中に`git status`を確認し、変更があれば提案を検討する
   - ユーザーが作業を進めている間、適切なタイミングで提案する

### 提案の手順

1. **変更内容を確認**
   - `git status`で変更されたファイルを確認
   - `git diff --cached`でステージング済みの変更を確認
   - `git diff`でステージング前の変更も確認（提案の参考に）

2. **コミットの必要性を判断**
   - 変更が意味のある単位になっているか
   - コミットすることで履歴が明確になるか
   - **判断に迷ったら、積極的に提案する**（ユーザーが判断する）

3. **コミットメッセージを提案**
   - 変更内容を分析
   - 適切なプレフィックスを選択
   - 30文字程度の日本語メッセージを作成
   - **ステージング済みの変更がある場合は、それを優先して提案**
   - **ステージング前の変更がある場合は、それも含めて提案できる**

4. **ユーザーに提案**
   - 「コミットしますか？このコミットメッセージでいかがでしょうか：」
   - コミットメッセージをコピーできる形で提示
   - **Git操作（commit）は提案しない、メッセージの考案のみ**
   - ユーザーは自分でGit操作を行う
   - **ユーザーが「まだ」「後で」と言ったら、それに従う**

### 注意点

- **押し付けがましくない**
  - ユーザーが「まだ」と言ったら、無理に進めない
  - 提案するだけで、強制しない

- **ステージング状態を確認**
  - 提案時は`git status`でステージング状態を確認
  - ステージングされていない変更があれば、それも含めて提案できる

- **コミットメッセージのルールに従う**
  - 日本語で記述
  - 「feat: 変更内容」形式
  - 30文字程度に収める

### 実装例

**提案の例：**
```
作業完了後、git statusを確認：
「変更がまとまりましたね。このコミットメッセージでコミットできます：

feat: ユーザー認証機能を追加

（ユーザーが自分でgit commitを実行）」
```

## まとめ

commitメッセージ作成時は：
1. 日本語で記述
2. 「feat: 変更内容」形式
3. 30文字程度に収める
4. **`git add`済みの変更のみを対象とする**
5. ステージング前の変更は参照しない
6. **コピーできる形で文字列を提供する**（実際のcommit操作はユーザーが行う）

**AIによる能動的な提案：**
- 作業の区切りでコミットを提案する
- 変更内容を確認し、適切なコミットメッセージを提案する
- ユーザーが選択できる余地を残す
